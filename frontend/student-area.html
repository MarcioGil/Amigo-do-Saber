<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Ãrea do aluno - Amigo do Saber" />
    <title>Ãrea do Aluno | Amigo do Saber</title>

    <!-- CSS -->
    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/variables.css" />
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/components.css" />
    <link rel="stylesheet" href="css/accessibility.css" />

    <style>
      .mission-card {
        background: linear-gradient(
          135deg,
          var(--primary-50) 0%,
          var(--primary-100) 100%
        );
        border-left: 4px solid var(--primary-500);
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
        margin-bottom: var(--spacing-sm);
      }

      .mission-card.completed {
        background: linear-gradient(
          135deg,
          var(--success-50) 0%,
          var(--success-100) 100%
        );
        border-left-color: var(--success-500);
        opacity: 0.7;
      }

      .quick-action {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: var(--spacing-lg);
        border-radius: var(--radius-lg);
        border: 2px solid var(--gray-200);
        transition: all var(--transition-base);
        cursor: pointer;
        text-decoration: none;
        color: var(--text-primary);
        min-height: 140px;
      }

      .quick-action:hover,
      .quick-action:focus {
        border-color: var(--primary-400);
        transform: translateY(-4px);
        box-shadow: var(--shadow-lg);
      }

      .quick-action-icon {
        font-size: 3rem;
        margin-bottom: var(--spacing-sm);
      }

      .level-badge {
        display: inline-flex;
        align-items: center;
        gap: var(--spacing-xs);
        background: linear-gradient(
          135deg,
          var(--primary-500),
          var(--primary-600)
        );
        color: white;
        padding: var(--spacing-xs) var(--spacing-md);
        border-radius: var(--radius-full);
        font-weight: 700;
        font-size: var(--text-sm);
      }

      .streak-display {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
        font-size: var(--text-lg);
        font-weight: 700;
        color: var(--warning-600);
      }

      @keyframes celebration {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.2);
        }
      }

      .celebrate {
        animation: celebration 0.5s ease-in-out;
      }
    </style>
  </head>
  <body>
    <!-- Skip Link -->
    <a href="#main-content" class="skip-link">Pular para o conteÃºdo</a>

    <!-- Header -->
    <header class="header">
      <div class="container">
        <div class="header-content">
          <a href="index.html" class="logo"> ğŸ“š Amigo do Saber </a>

          <nav class="nav" id="main-nav">
            <a href="dashboard.html" class="nav-link">Painel</a>
            <a href="student-area.html" class="nav-link active"
              >Ãrea do Aluno</a
            >
            <a href="tia-dora.html" class="nav-link">Tia Dora</a>
            <a href="#" class="nav-link" onclick="logout()">Sair</a>
          </nav>

          <button class="menu-toggle" id="menu-toggle" aria-label="Abrir menu">
            <span></span>
            <span></span>
            <span></span>
          </button>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="section">
      <div class="container">
        <!-- Welcome Banner -->
        <div
          class="card"
          style="
            background: linear-gradient(
              135deg,
              var(--primary-500) 0%,
              var(--primary-700) 100%
            );
            color: white;
            margin-bottom: var(--spacing-xl);
          "
        >
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              flex-wrap: wrap;
              gap: var(--spacing-md);
            "
          >
            <div>
              <h1 style="margin-bottom: var(--spacing-xs)">
                OlÃ¡, <span id="student-name">Aluno</span>! ğŸ‰
              </h1>
              <p style="opacity: 0.9">Continue sua jornada de aprendizado</p>
            </div>
            <div style="text-align: right">
              <div class="level-badge" id="level-display">â­ NÃ­vel 1</div>
              <div
                class="streak-display"
                style="color: white; margin-top: var(--spacing-sm)"
              >
                <span>ğŸ”¥</span>
                <span id="streak-count">0</span>
                <span style="font-size: var(--text-sm); font-weight: normal"
                  >dias seguidos</span
                >
              </div>
            </div>
          </div>

          <!-- Progress Bar -->
          <div style="margin-top: var(--spacing-lg)">
            <div
              style="
                display: flex;
                justify-content: space-between;
                margin-bottom: var(--spacing-xs);
                font-size: var(--text-sm);
              "
            >
              <span>Progresso para o prÃ³ximo nÃ­vel</span>
              <span id="progress-percentage">0%</span>
            </div>
            <div class="progress">
              <div
                class="progress-bar"
                id="progress-bar"
                style="width: 0%"
                role="progressbar"
                aria-valuenow="0"
                aria-valuemin="0"
                aria-valuemax="100"
              ></div>
            </div>
          </div>
        </div>

        <!-- MissÃµes DiÃ¡rias -->
        <section style="margin-bottom: var(--spacing-2xl)">
          <h2
            style="
              margin-bottom: var(--spacing-lg);
              display: flex;
              align-items: center;
              gap: var(--spacing-sm);
            "
          >
            ğŸ¯ MissÃµes de Hoje
          </h2>

          <div id="missions-container">
            <!-- MissÃµes serÃ£o inseridas aqui via JS -->
            <div class="mission-card">
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  align-items: start;
                  margin-bottom: var(--spacing-sm);
                "
              >
                <div style="flex: 1">
                  <h3
                    style="
                      font-size: var(--text-base);
                      margin-bottom: var(--spacing-2xs);
                    "
                  >
                    Carregando missÃµes...
                  </h3>
                  <p
                    style="
                      font-size: var(--text-sm);
                      color: var(--text-secondary);
                    "
                  >
                    Aguarde
                  </p>
                </div>
                <span class="badge badge-info">--</span>
              </div>
              <div class="progress" style="height: 8px">
                <div class="progress-bar" style="width: 0%"></div>
              </div>
            </div>
          </div>
        </section>

        <!-- Acesso RÃ¡pido -->
        <section style="margin-bottom: var(--spacing-2xl)">
          <h2 style="margin-bottom: var(--spacing-lg)">Acesso RÃ¡pido</h2>

          <div class="grid-4">
            <a href="tia-dora.html" class="quick-action">
              <div class="quick-action-icon">ğŸ€</div>
              <strong>Tia Dora</strong>
              <span
                style="font-size: var(--text-sm); color: var(--text-secondary)"
                >Tire dÃºvidas</span
              >
            </a>

            <a href="games/index.html" class="quick-action">
              <div class="quick-action-icon">ğŸ®</div>
              <strong>Jogar</strong>
              <span
                style="font-size: var(--text-sm); color: var(--text-secondary)"
                >Mini-games</span
              >
            </a>

            <a href="#" onclick="showProgressModal()" class="quick-action">
              <div class="quick-action-icon">ğŸ“Š</div>
              <strong>Meu Progresso</strong>
              <span
                style="font-size: var(--text-sm); color: var(--text-secondary)"
                >Veja suas conquistas</span
              >
            </a>

            <a href="#" onclick="showSubjectsModal()" class="quick-action">
              <div class="quick-action-icon">ğŸ“š</div>
              <strong>Estudar</strong>
              <span
                style="font-size: var(--text-sm); color: var(--text-secondary)"
                >Escolha a matÃ©ria</span
              >
            </a>
          </div>
        </section>

        <!-- Minhas Conquistas -->
        <section style="margin-bottom: var(--spacing-2xl)">
          <h2 style="margin-bottom: var(--spacing-lg)">
            Minhas Conquistas Recentes ğŸ†
          </h2>

          <div class="card">
            <div
              id="badges-container"
              style="display: flex; gap: var(--spacing-md); flex-wrap: wrap"
            >
              <!-- Badges serÃ£o inseridos aqui via JS -->
              <div style="text-align: center; padding: var(--spacing-md)">
                <div style="font-size: 3rem; margin-bottom: var(--spacing-xs)">
                  ğŸ†
                </div>
                <p
                  style="
                    font-size: var(--text-sm);
                    color: var(--text-secondary);
                  "
                >
                  Carregando conquistas...
                </p>
              </div>
            </div>
          </div>
        </section>

        <!-- Continue Estudando -->
        <section>
          <h2 style="margin-bottom: var(--spacing-lg)">Continue Estudando</h2>

          <div class="grid-2">
            <div class="card">
              <div
                style="
                  display: flex;
                  gap: var(--spacing-md);
                  align-items: start;
                "
              >
                <div style="font-size: 2.5rem">ğŸ“</div>
                <div style="flex: 1">
                  <h3 style="margin-bottom: var(--spacing-xs)">MatemÃ¡tica</h3>
                  <p
                    style="
                      font-size: var(--text-sm);
                      color: var(--text-secondary);
                      margin-bottom: var(--spacing-md);
                    "
                  >
                    Ãšltimo tÃ³pico: FraÃ§Ãµes
                  </p>
                  <div
                    class="progress"
                    style="margin-bottom: var(--spacing-sm)"
                  >
                    <div
                      class="progress-bar"
                      style="width: 65%"
                      role="progressbar"
                      aria-valuenow="65"
                      aria-valuemin="0"
                      aria-valuemax="100"
                    ></div>
                  </div>
                  <p
                    style="
                      font-size: var(--text-sm);
                      color: var(--text-secondary);
                    "
                  >
                    65% completo
                  </p>
                </div>
              </div>
              <a
                href="#"
                class="btn btn-primary"
                style="width: 100%; margin-top: var(--spacing-md)"
              >
                Continuar â†’
              </a>
            </div>

            <div class="card">
              <div
                style="
                  display: flex;
                  gap: var(--spacing-md);
                  align-items: start;
                "
              >
                <div style="font-size: 2.5rem">ğŸ“–</div>
                <div style="flex: 1">
                  <h3 style="margin-bottom: var(--spacing-xs)">PortuguÃªs</h3>
                  <p
                    style="
                      font-size: var(--text-sm);
                      color: var(--text-secondary);
                      margin-bottom: var(--spacing-md);
                    "
                  >
                    Ãšltimo tÃ³pico: Verbos
                  </p>
                  <div
                    class="progress"
                    style="margin-bottom: var(--spacing-sm)"
                  >
                    <div
                      class="progress-bar"
                      style="width: 40%"
                      role="progressbar"
                      aria-valuenow="40"
                      aria-valuemin="0"
                      aria-valuemax="100"
                    ></div>
                  </div>
                  <p
                    style="
                      font-size: var(--text-sm);
                      color: var(--text-secondary);
                    "
                  >
                    40% completo
                  </p>
                </div>
              </div>
              <a
                href="#"
                class="btn btn-primary"
                style="width: 100%; margin-top: var(--spacing-md)"
              >
                Continuar â†’
              </a>
            </div>
          </div>
        </section>
      </div>
    </main>

    <!-- Modal: Progresso Detalhado -->
    <div id="progress-modal" class="modal-overlay" style="display: none">
      <div
        class="modal"
        role="dialog"
        aria-labelledby="progress-title"
        aria-modal="true"
        style="max-width: 600px"
      >
        <div class="modal-header">
          <h3 id="progress-title">ğŸ“Š Meu Progresso</h3>
          <button
            class="modal-close"
            onclick="closeModal('progress-modal')"
            aria-label="Fechar modal"
          >
            &times;
          </button>
        </div>
        <div class="modal-body">
          <div style="margin-bottom: var(--spacing-lg)">
            <h4 style="margin-bottom: var(--spacing-sm)">
              EstatÃ­sticas Gerais
            </h4>
            <div class="grid-2" style="gap: var(--spacing-sm)">
              <div
                style="
                  background: var(--primary-50);
                  padding: var(--spacing-md);
                  border-radius: var(--radius-md);
                "
              >
                <p
                  style="
                    font-size: var(--text-sm);
                    color: var(--text-secondary);
                  "
                >
                  Pontos Totais
                </p>
                <p
                  style="
                    font-size: var(--text-2xl);
                    font-weight: 700;
                    color: var(--primary-600);
                  "
                  id="modal-pontos"
                >
                  --
                </p>
              </div>
              <div
                style="
                  background: var(--success-50);
                  padding: var(--spacing-md);
                  border-radius: var(--radius-md);
                "
              >
                <p
                  style="
                    font-size: var(--text-sm);
                    color: var(--text-secondary);
                  "
                >
                  ExercÃ­cios Feitos
                </p>
                <p
                  style="
                    font-size: var(--text-2xl);
                    font-weight: 700;
                    color: var(--success-600);
                  "
                  id="modal-exercicios"
                >
                  --
                </p>
              </div>
            </div>
          </div>

          <div>
            <h4 style="margin-bottom: var(--spacing-sm)">
              Progresso por MatÃ©ria
            </h4>
            <div
              id="modal-materias"
              style="
                display: flex;
                flex-direction: column;
                gap: var(--spacing-md);
              "
            >
              <!-- Progresso por matÃ©ria serÃ¡ inserido aqui -->
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button
            class="btn btn-primary"
            onclick="closeModal('progress-modal')"
          >
            Fechar
          </button>
        </div>
      </div>
    </div>

    <!-- Modal: Escolher MatÃ©ria -->
    <div id="subjects-modal" class="modal-overlay" style="display: none">
      <div
        class="modal"
        role="dialog"
        aria-labelledby="subjects-title"
        aria-modal="true"
      >
        <div class="modal-header">
          <h3 id="subjects-title">ğŸ“š Escolha a MatÃ©ria</h3>
          <button
            class="modal-close"
            onclick="closeModal('subjects-modal')"
            aria-label="Fechar modal"
          >
            &times;
          </button>
        </div>
        <div class="modal-body">
          <div class="grid-2" style="gap: var(--spacing-md)">
            <button
              class="btn btn-outline"
              style="
                padding: var(--spacing-lg);
                height: auto;
                display: flex;
                flex-direction: column;
                gap: var(--spacing-xs);
              "
            >
              <span style="font-size: 2rem">ğŸ“</span>
              <strong>MatemÃ¡tica</strong>
            </button>
            <button
              class="btn btn-outline"
              style="
                padding: var(--spacing-lg);
                height: auto;
                display: flex;
                flex-direction: column;
                gap: var(--spacing-xs);
              "
            >
              <span style="font-size: 2rem">ğŸ“–</span>
              <strong>PortuguÃªs</strong>
            </button>
            <button
              class="btn btn-outline"
              style="
                padding: var(--spacing-lg);
                height: auto;
                display: flex;
                flex-direction: column;
                gap: var(--spacing-xs);
              "
            >
              <span style="font-size: 2rem">ğŸ”¬</span>
              <strong>CiÃªncias</strong>
            </button>
            <button
              class="btn btn-outline"
              style="
                padding: var(--spacing-lg);
                height: auto;
                display: flex;
                flex-direction: column;
                gap: var(--spacing-xs);
              "
            >
              <span style="font-size: 2rem">ğŸ—ºï¸</span>
              <strong>Geografia</strong>
            </button>
            <button
              class="btn btn-outline"
              style="
                padding: var(--spacing-lg);
                height: auto;
                display: flex;
                flex-direction: column;
                gap: var(--spacing-xs);
              "
            >
              <span style="font-size: 2rem">ğŸ“œ</span>
              <strong>HistÃ³ria</strong>
            </button>
            <button
              class="btn btn-outline"
              style="
                padding: var(--spacing-lg);
                height: auto;
                display: flex;
                flex-direction: column;
                gap: var(--spacing-xs);
              "
            >
              <span style="font-size: 2rem">ğŸ—£ï¸</span>
              <strong>InglÃªs</strong>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/main.js"></script>
    <script src="js/accessibility.js"></script>
    <script>
      // Verificar autenticaÃ§Ã£o
      const user = storage.get("user")
      if (!user) {
        window.location.href = "login.html"
      }

      // Carregar dados do aluno
      async function loadStudentData() {
        showLoader(true)

        try {
          const userData = JSON.parse(user)
          document.getElementById("student-name").textContent =
            userData.nome || "Aluno"

          // Mock gamification data - substituir por GET /api/gamificacao/{alunoId}
          const mockGamificacao = {
            pontos: 1250,
            nivel: "Aprendiz AvanÃ§ado",
            nivelNumero: 5,
            proximoNivel: "Expert",
            pontosProximoNivel: 1500,
            streak: {
              atual: 7,
              melhor: 12,
            },
            badges: [
              {
                nome: "MatemÃ¡tico",
                icone: "ğŸ”¢",
                descricao: "50 exercÃ­cios de matemÃ¡tica",
              },
              {
                nome: "Leitor AssÃ­duo",
                icone: "ğŸ“š",
                descricao: "50 exercÃ­cios de portuguÃªs",
              },
              {
                nome: "DedicaÃ§Ã£o Semanal",
                icone: "â­",
                descricao: "7 dias seguidos",
              },
            ],
            missoesDiarias: [
              {
                id: 1,
                descricao: "Complete 5 exercÃ­cios de MatemÃ¡tica",
                progresso: 3,
                meta: 5,
                pontos: 50,
                completa: false,
              },
              {
                id: 2,
                descricao: "Acerte 3 questÃµes seguidas",
                progresso: 2,
                meta: 3,
                pontos: 75,
                completa: false,
              },
              {
                id: 3,
                descricao: "Estude por 30 minutos",
                progresso: 30,
                meta: 30,
                pontos: 100,
                completa: true,
              },
            ],
          }

          // Atualizar interface
          updateGamificationUI(mockGamificacao)
          renderMissions(mockGamificacao.missoesDiarias)
          renderBadges(mockGamificacao.badges)
        } catch (error) {
          console.error("Erro ao carregar dados:", error)
          showToast("Erro ao carregar dados do aluno", "error")
        } finally {
          showLoader(false)
        }
      }

      // Atualizar UI de gamificaÃ§Ã£o
      function updateGamificationUI(data) {
        document.getElementById("level-display").innerHTML = `â­ ${data.nivel}`
        document.getElementById("streak-count").textContent = data.streak.atual

        const progressPercent = Math.floor(
          (data.pontos / data.pontosProximoNivel) * 100
        )
        document.getElementById(
          "progress-percentage"
        ).textContent = `${progressPercent}%`
        document.getElementById(
          "progress-bar"
        ).style.width = `${progressPercent}%`
        document
          .getElementById("progress-bar")
          .setAttribute("aria-valuenow", progressPercent)
      }

      // Renderizar missÃµes
      function renderMissions(missions) {
        const container = document.getElementById("missions-container")
        container.innerHTML = missions
          .map((mission) => {
            const progressPercent = Math.floor(
              (mission.progresso / mission.meta) * 100
            )
            const isComplete = mission.completa

            return `
          <div class="mission-card ${isComplete ? "completed" : ""}">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: var(--spacing-sm);">
              <div style="flex: 1;">
                <h3 style="font-size: var(--text-base); margin-bottom: var(--spacing-2xs);">
                  ${isComplete ? "âœ…" : "ğŸ¯"} ${mission.descricao}
                </h3>
                <p style="font-size: var(--text-sm); color: var(--text-secondary);">
                  ${mission.progresso}/${mission.meta} completo
                </p>
              </div>
              <span class="badge ${
                isComplete ? "badge-success" : "badge-info"
              }">
                +${mission.pontos} pts
              </span>
            </div>
            <div class="progress" style="height: 8px;">
              <div class="progress-bar" style="width: ${progressPercent}%;" role="progressbar" 
                   aria-valuenow="${progressPercent}" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
          </div>
        `
          })
          .join("")
      }

      // Renderizar badges
      function renderBadges(badges) {
        const container = document.getElementById("badges-container")
        container.innerHTML = badges
          .map(
            (badge) => `
        <div style="text-align: center; padding: var(--spacing-md); background: var(--gray-50); border-radius: var(--radius-md);">
          <div style="font-size: 3rem; margin-bottom: var(--spacing-xs);">${badge.icone}</div>
          <p style="font-weight: 700; margin-bottom: var(--spacing-2xs); font-size: var(--text-sm);">${badge.nome}</p>
          <p style="font-size: var(--text-xs); color: var(--text-secondary);">${badge.descricao}</p>
        </div>
      `
          )
          .join("")
      }

      // Mostrar modal de progresso
      function showProgressModal() {
        // Mock data
        document.getElementById("modal-pontos").textContent = "1250"
        document.getElementById("modal-exercicios").textContent = "125"

        const mockMaterias = [
          { nome: "MatemÃ¡tica", progresso: 65, icone: "ğŸ“" },
          { nome: "PortuguÃªs", progresso: 40, icone: "ğŸ“–" },
          { nome: "CiÃªncias", progresso: 80, icone: "ğŸ”¬" },
          { nome: "HistÃ³ria", progresso: 30, icone: "ğŸ“œ" },
        ]

        document.getElementById("modal-materias").innerHTML = mockMaterias
          .map(
            (materia) => `
        <div>
          <div style="display: flex; justify-content: space-between; margin-bottom: var(--spacing-xs);">
            <span>${materia.icone} ${materia.nome}</span>
            <strong>${materia.progresso}%</strong>
          </div>
          <div class="progress">
            <div class="progress-bar" style="width: ${materia.progresso}%;" role="progressbar" 
                 aria-valuenow="${materia.progresso}" aria-valuemin="0" aria-valuemax="100"></div>
          </div>
        </div>
      `
          )
          .join("")

        showModal("progress-modal")
      }

      // Mostrar modal de matÃ©rias
      function showSubjectsModal() {
        showModal("subjects-modal")
      }

      // Logout
      function logout() {
        storage.remove("user")
        storage.remove("authToken")
        window.location.href = "login.html"
      }

      // Carregar dados ao iniciar
      loadStudentData()
    </script>
  </body>
</html>
